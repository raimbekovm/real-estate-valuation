# Тюнинг гиперпараметров — 29 декабря 2024

## Методология
- **Оптимизатор**: Optuna с TPE sampler
- **Trials**: 50 на каждую модель
- **Валидация**: 5-Fold Cross-Validation
- **Метрика оптимизации**: MAE (Mean Absolute Error)

## Результаты

### Сравнение до и после тюнинга

| Модель | MAE (до) | MAE (после) | R² (до) | R² (после) | Улучшение |
|--------|----------|-------------|---------|------------|-----------|
| **XGBoost** | $145 | **$129 ± $2** | 0.600 | **0.682** | -11% MAE |
| CatBoost | $163 | $130 ± $3 | 0.538 | 0.686 | -20% MAE |
| LightGBM | $147 | $133 ± $3 | 0.595 | 0.684 | -10% MAE |

### Лучшие гиперпараметры

#### XGBoost (победитель)
```python
{
    'n_estimators': 228,
    'max_depth': 9,
    'learning_rate': 0.046,
    'subsample': 0.947,
    'colsample_bytree': 0.697,
    'min_child_weight': 1,
    'reg_alpha': 3.47e-06,
    'reg_lambda': 0.001
}
```

#### LightGBM
```python
{
    'n_estimators': 435,
    'max_depth': 10,
    'learning_rate': 0.095,
    'subsample': 0.999,
    'colsample_bytree': 0.893,
    'min_child_samples': 5,
    'reg_alpha': 0.0016,
    'reg_lambda': 0.0003
}
```

#### CatBoost
```python
{
    'iterations': 422,
    'depth': 10,
    'learning_rate': 0.092,
    'l2_leaf_reg': 5.8e-08,
    'bagging_temperature': 0.484,
    'random_strength': 1.03e-05
}
```

## Итоговое сравнение моделей (5-Fold CV)

| Модель | MAE | RMSE | R² |
|--------|-----|------|-----|
| **XGBoost** | **$129 ± $2** | $211 ± $21 | 0.682 ± 0.040 |
| CatBoost | $130 ± $3 | $210 ± $19 | **0.686 ± 0.031** |
| LightGBM | $133 ± $3 | $211 ± $19 | 0.684 ± 0.027 |

## Выводы

1. **XGBoost — лучший по MAE** ($129/м²)
   - Самая низкая ошибка
   - Самый низкий std (± $2) — стабильный

2. **CatBoost — лучший по R²** (0.686)
   - Максимально объяснённая дисперсия
   - Сильно улучшился после тюнинга (-20% MAE)

3. **LightGBM — средний результат**
   - Быстрый в обучении
   - Хороший компромисс скорость/качество

4. **Все модели сравнялись после тюнинга**
   - До: разброс $145-163 (18$ разницы)
   - После: разброс $129-133 (4$ разницы)

## Интерпретация

- **Медианная цена**: $1,560/м²
- **Ошибка лучшей модели**: $129/м² (8.3% от медианы)
- **R² = 0.68** означает: модель объясняет 68% вариации цен

Для оценки недвижимости это хороший результат — ошибка менее 10% позволяет использовать модель для предварительной оценки.
