# Новые признаки — 29 декабря 2024

## Добавленные признаки

### Из существующих данных (8 признаков)
| Признак | Источник | Описание |
|---------|----------|----------|
| `ceiling_height_clean` | ceiling_height | Высота потолков (заполнено медианой) |
| `has_separate_bathroom` | bathroom | Раздельный санузел |
| `has_multiple_bathrooms` | bathroom | 2+ санузла |
| `has_balcony` | balcony | Есть балкон/лоджия |
| `has_glazed_balcony` | balcony | Застеклённый балкон/лоджия |
| `has_parking` | parking | Есть паркинг |
| `is_elite` | building_series | Элитка |
| `is_soviet_series` | building_series | Советская серия (104, 105, 106...) |

### Производные признаки (8 признаков)
| Признак | Формула | Описание |
|---------|---------|----------|
| `area_per_room` | area / rooms | Площадь на комнату |
| `floor_ratio` | floor / total_floors | Относительный этаж (0-1) |
| `is_first_floor` | floor == 1 | Первый этаж |
| `is_last_floor` | floor == total_floors | Последний этаж |
| `is_middle_floor` | 1 < floor < total_floors | Средний этаж |
| `is_new_building` | year_built >= 2020 | Новостройка |
| `is_highrise` | total_floors >= 10 | Высотка |
| `is_lowrise` | total_floors <= 5 | Малоэтажка |

### Категориальные
| Признак | Описание |
|---------|----------|
| `building_series_cat` | Серия дома (elite, soviet_104, etc.) |
| `building_decade` | Декада постройки (1960s, 1970s...) |

## Результаты

### Сравнение до и после (baseline без тюнинга)

| Модель | MAE (до) | MAE (после) | R² (до) | R² (после) |
|--------|----------|-------------|---------|------------|
| XGBoost | $145 | **$141** | 0.600 | **0.616** |
| Random Forest | $144 | $142 | 0.610 | **0.619** |
| LightGBM | $147 | **$143** | 0.595 | **0.610** |
| Linear | $240 | $239 | 0.215 | **0.231** |

### Важность новых признаков (XGBoost)

| Ранг | Признак | Важность |
|------|---------|----------|
| 3 | ceiling_height_clean | 5.8% |
| 5 | is_highrise | 2.7% |
| 6 | is_elite | 2.5% |
| 14 | has_parking | 1.8% |

## Выводы

1. **Высота потолков важна** — попала в топ-3 признаков (5.8%)

2. **Элитность и высотность** — is_elite и is_highrise влияют на цену

3. **Паркинг** — has_parking тоже используется моделью

4. **Улучшение качества**:
   - XGBoost: MAE снизился на $4 (2.8%)
   - R² вырос на 1.6% (0.600 → 0.616)

5. **Количество признаков**: 25 → 42 (+17)
